apply plugin: 'java'
apply plugin: 'application'

mainClassName = 'jimageprocessor.JImageProcessor'

// tag::repositories[]
repositories {
	mavenCentral()
}
// end::repositories[]

// tag::jar[]
jar {
	baseName = 'JMathImgProc'
	version =  '1.7.4.67'
	manifest { 
		attributes "Main-Class": "$mainClassName"
	}  

	from {
		configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
	}
}
// end::jar[]

sourceSets {
	main {
		java {
			srcDirs = ["src"]
		}
	}
}

sourceCompatibility = 1.7
targetCompatibility = 1.7

// tag::dependencies[]
dependencies {
	compile fileTree(dir: '../CoreMathImgProc/bin', include: ['CoreMathImgProc.jar'])
}
// end::dependencies[]

// tag::wrapper[]
// end::wrapper[]

task deployJar(type: Copy) {
	doLast {
		println "Now copy build/libs/${jar.baseName}-${jar.version}.jar into bin/${jar.baseName}.jar"
	}
	from jar  // here it automatically reads jar file produced from jar task
	into "bin"
	rename { fileName -> fileName.replace "-${jar.version}", "" }
}

build.finalizedBy deployJar